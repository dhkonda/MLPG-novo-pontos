   
!##################################################################################
!Subrotina para abrir o arquivo de saida e gravar a hora inicial
!##################################################################################
SUBROUTINE OPEN_OUTPUT(ARQS,MON,ALFA,ALFA2,SHAPE,E,NI,T,CARGA)
IMPLICIT NONE

CHARACTER*20:: ARQS
REAL*8:: ALFA,ALFA2,E,NI,T,CARGA
INTEGER::MON,SHAPE
INTEGER  IANO,IMES,IDIA,IHORA,IMIN,ISEC,I100TH

CALL GETDAT(IANO,IMES,IDIA)
CALL GETTIM(IHORA,IMIN,ISEC,I100TH)

WRITE(2,30)IDIA,IMES,IANO,IHORA,IMIN,ISEC,I100TH
30 FORMAT(/,5X,74('*'),/,2(5X,1H*,72X,1H*,/),5X,1H*,18X, 'ANALISE NAO-LINEAR DE PLACAS ESPESSAS',&
   17X,1H*,/,5X,1H*,72X,1H*,/,5X, 1H*,20X,'MESHLESS LOCAL PETROV-GALERKIN',20X,1H*,/, 2(5X,1H*, 72X,&
     1H*,/),5X,74('*'),/,5X,1H*,52X,1H*,19X,1H*,/, 5X,1H*,52X, 1H*,2X,'DATA: ',I2.2,1H-,I2.2,1H-,&
      I4.4,1X,1H*,/,5X,1H*,16X, 'DANILO HIROSHI KONDA',16X,1H*,19X,1H*,/,5X,1H*,52X, 1H*,2X,'HORA: ',&
      I2.2,1H:,I2.2,1H:,I2.2,1H:,I2.2,1H*,/,5X,1H*, 52X, 1H*,19X,1H*,/,5X,74('*'),//,5X,'DESCRICAO DO PROBLEMA')
   
IF(MON.EQ.1)THEN
	WRITE(2,32) 
32 FORMAT (//,10X,'APROXIMACAO LINEAR')
ELSE IF(MON.EQ.2) THEN
	WRITE(2,34) 
34 FORMAT (//,10X,'APROXIMACAO QUADRATICA')
ELSE IF(MON.EQ.3) THEN
	WRITE(2,36) 
36  FORMAT (//,10X,'APROXIMACAO CUBICA')
ELSE IF(MON.EQ.4) THEN
	WRITE(2,39) 
39  FORMAT (//,10X,'APROXIMACAO 4 GRAU')
ELSE IF(MON.EQ.5) THEN
	WRITE(2,41) 
41  FORMAT (//,10X,'APROXIMACAO 5 GRAU')
    ELSE IF(MON.EQ.6) THEN
	WRITE(2,42) 
42 FORMAT (//,10X,'APROXIMACAO 6 GRAU')
ELSE
	WRITE(*,*) 'ERRO NA ESCOLHA DA APROXIMACAO'
	READ(*,*)
	STOP
ENDIF

 IF(ABS(ALFA).LT.ALFA2)THEN
    WRITE(2,38) 
38  FORMAT (//,10X,'MET. DE COLOCAÇÃO PARA IMPOSICÃO DE DESL. PRESCRITO')
 ELSE IF (ABS(ALFA).GE.ALFA2) THEN
    WRITE(2,40) alfa
40  FORMAT (//,10X,'MET. DA PENALIDADE PARA IMPOSICÃO DE DESL. PRESCRITO',3x,e10.5) 
 ENDIF
 
  IF(SHAPE.EQ.1)THEN
    WRITE(2,44) 
44  FORMAT (/,10X,'MLS PARA APROXIMAÇÃO DOS DESL.')
 ELSE IF (SHAPE.EQ.2) THEN
    WRITE(2,48) 
48  FORMAT (/,10X,'RPIM PARA APROXIMACAO DOS DESLOCAMENTO') 
 ENDIF

 WRITE(2,52) E,NI,T,CARGA
 52 FORMAT(/,10X,'MODULO DE ELASTICIDADE =',14X,F14.5,//,10X,'COEFICIENTE DE POISSON =',15X,F5.3,//,10X,'ESPESSURA DA PLACA =',17X,&
    F8.4,//,10X,'CARREGAMENTO DISTRIBUIDO NA PLACA =',F12.5)
 
 
RETURN
ENDSUBROUTINE OPEN_OUTPUT
    